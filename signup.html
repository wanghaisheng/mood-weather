
<html><head><base href="https://moodweather.heytcm.com/signup"><meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - MoodWeather</title>
    <style>
        :root {
            --primary: #2D3250;
            --secondary: #424769;
            --accent: #7077A1;
            --light: #F6B17A;
            --error: #ff6b6b;
            --success: #51cf66;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--primary);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        nav {
            background: var(--secondary);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--light);
            text-decoration: none;
        }

        .locale-picker {
            padding: 8px 12px;
            border-radius: 20px;
            border: 2px solid var(--light);
            background: var(--secondary);
            color: white;
            font-size: 14px;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
        }

        .locale-picker:hover {
            background: var(--primary);
            border-color: var(--accent);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .signup-container {
            background: var(--secondary);
            padding: 2rem;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .background-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.1;
        }

        .form-content {
            position: relative;
            z-index: 1;
        }

        h1 {
            text-align: center;
            color: var(--light);
            margin-bottom: 1.5rem;
            font-size: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: rgba(255,255,255,0.9);
        }

        input {
            width: 100%;
            padding: 0.8rem;
            border-radius: 8px;
            border: 2px solid transparent;
            background: rgba(255,255,255,0.1);
            color: white;
            transition: all 0.3s;
        }

        input:focus {
            outline: none;
            border-color: var(--light);
            background: rgba(255,255,255,0.15);
        }

        .password-container {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            padding: 0.5rem;
        }

        .toggle-password:hover {
            color: var(--light);
        }

        .strength-meter {
            height: 4px;
            background: rgba(255,255,255,0.1);
            margin-top: 0.5rem;
            border-radius: 2px;
            overflow: hidden;
        }

        .strength-meter-fill {
            height: 100%;
            width: 0;
            transition: width 0.3s, background-color 0.3s;
        }

        .password-requirements {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.7);
            margin-top: 0.5rem;
        }

        .requirement {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.25rem;
        }

        .requirement.met {
            color: var(--success);
        }

        .signup-button {
            width: 100%;
            padding: 1rem;
            background: var(--light);
            color: var(--primary);
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .signup-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(246,177,122,0.3);
        }

        .signup-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .social-signup {
            margin-top: 2rem;
            text-align: center;
        }

        .social-signup p {
            margin-bottom: 1rem;
            color: rgba(255,255,255,0.7);
        }

        .social-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .social-button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .social-button:hover {
            transform: translateY(-2px);
        }

        .google-button {
            background: white;
            color: #333;
        }

        .github-button {
            background: #333;
            color: white;
        }

        .error-message {
            color: var(--error);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .success-message {
            color: var(--success);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .terms {
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
            text-align: center;
        }

        .terms a {
            color: var(--light);
            text-decoration: none;
            font-weight: bold;
        }

        .terms a:hover {
            text-decoration: underline;
        }

        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }

            .signup-container {
                padding: 1.5rem;
            }

            .social-buttons {
                flex-direction: column;
            }

            .social-button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Add loading animation styles */
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .loading {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary);
            border-top-color: transparent;
            border-radius: 50%;
            animation: rotate 1s linear infinite;
            margin: 0 auto;
        }

        .signup-button.loading .button-text {
            display: none;
        }

        .signup-button.loading .loading {
            display: block;
        }

    </style>
</head>
<body>
    <nav>
        <a href="/" class="logo">üå§Ô∏è MoodWeather</a>
        <select id="locale-picker" class="locale-picker">
            <option value="en">English</option>
            <option value="es">Espa√±ol</option>
            <option value="fr">Fran√ßais</option>
            <option value="ja">Êó•Êú¨Ë™û</option>
            <option value="de">Deutsch</option>
            <option value="zh">‰∏≠Êñá</option>
        </select>
    </nav>

    <div class="container">
        <div class="signup-container">
            <svg class="background-animation" viewBox="0 0 100 100" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:var(--accent);stop-opacity:0.3" />
                        <stop offset="100%" style="stop-color:var(--light);stop-opacity:0.3" />
                    </linearGradient>
                </defs>
                <path fill="url(#gradient)" d="M0,0 C20,10 50,30 100,0 L100,100 L0,100 Z">
                    <animate attributeName="d" 
                        dur="8s" 
                        repeatCount="indefinite"
                        values="M0,0 C20,10 50,30 100,0 L100,100 L0,100 Z;
                                M0,0 C30,20 60,10 100,0 L100,100 L0,100 Z;
                                M0,0 C40,30 40,40 100,0 L100,100 L0,100 Z;
                                M0,0 C20,10 50,30 100,0 L100,100 L0,100 Z" />
                </path>
            </svg>

            <div class="form-content">
                <h1>Join MoodWeather</h1>
                <form id="signup-form">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" required>
                        <div class="error-message" id="email-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" required>
                        <div class="error-message" id="username-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="password">Password</label>
                        <div class="password-container">
                            <input type="password" id="password" required>
                            <button type="button" class="toggle-password" aria-label="Toggle password visibility">üëÅÔ∏è</button>
                        </div>
                        <div class="strength-meter">
                            <div class="strength-meter-fill"></div>
                        </div>
                        <div class="password-requirements">
                            <div class="requirement" id="length-req">At least 8 characters</div>
                            <div class="requirement" id="uppercase-req">One uppercase letter</div>
                            <div class="requirement" id="lowercase-req">One lowercase letter</div>
                            <div class="requirement" id="number-req">One number</div>
                            <div class="requirement" id="special-req">One special character</div>
                        </div>
                        <div class="error-message" id="password-error"></div>
                    </div>

                    <button type="submit" class="signup-button" disabled>
                        <span class="button-text">Create Account</span>
                        <div class="loading"></div>
                    </button>

                    <div class="social-signup">
                        <p>Or sign up with</p>
                        <div class="social-buttons">
                            <button type="button" class="social-button google-button">
                                <svg width="20" height="20" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1Z"/>
                                </svg>
                                Google
                            </button>
                            <button type="button" class="social-button github-button">
                                <svg width="20" height="20" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"/>
                                </svg>
                                GitHub
                            </button>
                        </div>
                    </div>

                    <div class="terms">
                        By signing up, you agree to our <a href="https://moodweather.heytcm.com/terms">Terms of Service</a> and <a href="https://moodweather.heytcm.com/privacy">Privacy Policy</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Initialize locale picker
        function initLocalePicker() {
            const localePicker = document.getElementById('locale-picker');
            
            // Get current locale from URL
            const getCurrentLocale = () => {
                const path = window.location.pathname;
                const matches = path.match(/\/([a-z]{2})\//);
                return matches ? matches[1] : 'en';
            };

            // Set initial value based on URL
            const currentLocale = getCurrentLocale();
            localePicker.value = currentLocale;

            // Handle locale change
            localePicker.addEventListener('change', (e) => {
                const newLocale = e.target.value;
                const currentPath = window.location.pathname;
                
                // If current path already has locale
                if (currentPath.match(/\/[a-z]{2}\//)) {
                    window.location.pathname = currentPath.replace(/\/[a-z]{2}\//, `/${newLocale}/`);
                } else {
                    // If no locale in path, add it
                    window.location.pathname = `/${newLocale}${currentPath}`;
                }
            });
        }

        // Password visibility toggle
        document.querySelector('.toggle-password').addEventListener('click', function() {
            const passwordInput = document.getElementById('password');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è';
        });

        // Password strength checker
        const passwordInput = document.getElementById('password');
        const strengthMeter = document.querySelector('.strength-meter-fill');
        const signupButton = document.querySelector('.signup-button');

        const requirements = {
            length: str => str.length >= 8,
            uppercase: str => /[A-Z]/.test(str),
            lowercase: str => /[a-z]/.test(str),
            number: str => /[0-9]/.test(str),
            special: str => /[^A-Za-z0-9]/.test(str)
        };

        const requirementElements = {
            length: document.getElementById('length-req'),
            uppercase: document.getElementById('uppercase-req'),
            lowercase: document.getElementById('lowercase-req'),
            number: document.getElementById('number-req'),
            special: document.getElementById('special-req')
        };

        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            let requirementsMet = 0;

            // Check each requirement
            for (let [key, test] of Object.entries(requirements)) {
                const isMet = test(password);
                if (isMet) {
                    requirementsMet++;
                    strength += 20;
                    requirementElements[key].classList.add('met');
                } else {
                    requirementElements[key].classList.remove('met');
                }
            }

            // Update strength meter
            strengthMeter.style.width = `${strength}%`;
            if (strength <= 40) {
                strengthMeter.style.backgroundColor = '#ff4d4d';
            } else if (strength <= 80) {
                strengthMeter.style.backgroundColor = '#ffd700';
            } else {
                strengthMeter.style.backgroundColor = '#00cc00';
            }

            // Enable/disable signup button
            signupButton.disabled = requirementsMet !== 5;
        });

        // Form submission
        document.getElementById('signup-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const button = this.querySelector('.signup-button');
            button.classList.add('loading');
            button.disabled = true;

            // Clear previous error messages
            document.querySelectorAll('.error-message').forEach(elm => {
                elm.style.display = 'none';
                elm.textContent = '';
            });

            const email = document.getElementById('email').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('/api/signup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, username, password })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Signup failed');
                }

                // Successful signup
                window.location.href = '/onboarding';

            } catch (error) {
                // Handle different types of errors
                if (error.message.includes('email')) {
                    document.getElementById('email-error').textContent = error.message;
                    document.getElementById('email-error').style.display = 'block';
                } else if (error.message.includes('username')) {
                    document.getElementById('username-error').textContent = error.message;
                    document.getElementById('username-error').style.display = 'block';
                } else if (error.message.includes('password')) {
                    document.getElementById('password-error').textContent = error.message;
                    document.getElementById('password-error').style.display = 'block';
                } else {
                    // General error
                    alert('An error occurred. Please try again later.');
                }
            } finally {
                button.classList.remove('loading');
                button.disabled = false;
            }
        });

        // Social sign up handlers
        document.querySelector('.google-button').addEventListener('click', () => {
            window.location.href = '/api/auth/google';
        });

        document.querySelector('.github-button').addEventListener('click', () => {
            window.location.href = '/api/auth/github';
        });

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            initLocalePicker();
        });

        // Add real-time email validation
        const emailInput = document.getElementById('email');
        emailInput.addEventListener('input', function() {
            const email = this.value;
            const emailError = document.getElementById('email-error');
            
            if (!email) {
                emailError.textContent = 'Email is required';
                emailError.style.display = 'block';
                return;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                emailError.textContent = 'Please enter a valid email address';
                emailError.style.display = 'block';
            } else {
                emailError.style.display = 'none';
            }
        });

        // Add real-time username validation
        const usernameInput = document.getElementById('username');
        usernameInput.addEventListener('input', function() {
            const username = this.value;
            const usernameError = document.getElementById('username-error');
            
            if (!username) {
                usernameError.textContent = 'Username is required';
                usernameError.style.display = 'block';
                return;
            }

            if (username.length < 3) {
                usernameError.textContent = 'Username must be at least 3 characters long';
                usernameError.style.display = 'block';
            } else if (username.length > 20) {
                usernameError.textContent = 'Username must be less than 20 characters';
                usernameError.style.display = 'block';
            } else if (!/^[a-zA-Z0-9_-]+$/.test(username)) {
                usernameError.textContent = 'Username can only contain letters, numbers, underscores, and hyphens';
                usernameError.style.display = 'block';
            } else {
                usernameError.style.display = 'none';
            }
        });

        // Add animation to the background
        const animatePath = document.querySelector('.background-animation path');
        
        function updatePath() {
            const height = Math.random() * 30 + 20;
            const mid1 = Math.random() * 40 + 20;
            const mid2 = Math.random() * 40 + 40;
            
            const newPath = `M0,0 C${mid1},${height} ${mid2},${height} 100,0 L100,100 L0,100 Z`;
            animatePath.setAttribute('d', newPath);
        }

        setInterval(updatePath, 4000);
    </script>
</body></html>